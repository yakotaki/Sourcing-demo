{% extends "base.html" %}
{% block title %}
{{ (product.name_zh if lang == 'zh' else product.name) }} â€“ SkyLane Shop
{% endblock %}

{% block content %}
<nav aria-label="breadcrumb" class="mb-4">
  <ol class="breadcrumb">
    <li class="breadcrumb-item">
        <a href="{{ url_for('index') }}" class="text-decoration-none">{{ t.breadcrumb_home }}</a>
    </li>
    <li class="breadcrumb-item">
        <a href="{{ url_for('index', category=product.category) }}" class="text-decoration-none">
            {{ t["cat_" ~ product.category] }}
        </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">
        {{ product.name_zh if lang == 'zh' else product.name }}
    </li>
  </ol>
</nav>

<div class="row g-5 mb-5">
    <div class="col-md-6">
        <div class="bg-white p-3 rounded-4 shadow-sm">
            <img src="{{ url_for('static', filename='img/' ~ product.image) }}"
                 onerror="this.src='https://placehold.co/600x600?text={{ product.name | replace(' ', '+') }}'"
                 alt="{{ product.name if lang == 'en' else product.name_zh }}"
                 class="img-fluid rounded-3 w-100"
                 style="object-fit: cover;">
        </div>
    </div>
    <div class="col-md-6">
        <div class="h-100 d-flex flex-column justify-content-center">
            <span class="badge bg-primary-subtle text-primary mb-2 align-self-start">
                {{ t["cat_" ~ product.category] }}
            </span>
            <h1 class="display-6 fw-bold mb-2">
                {{ product.name if lang == 'en' else product.name_zh }}
            </h1>
            <div class="fs-2 fw-bold mb-4 text-primary">
                {{ product.price }} {{ product.currency }}
            </div>

            <p class="lead text-muted mb-4 fs-6">
                {{ product.description if lang == 'en' else product.description_zh }}
            </p>

            <hr class="my-4 text-muted opacity-25">

            <form action="{{ url_for('add_to_cart', pid=product.id) }}" method="post"
                  class="d-flex gap-3 align-items-end">
                <div style="width: 100px;">
                    <label for="qty" class="form-label small fw-bold text-muted">
                        {{ t.product_quantity }}
                    </label>
                    <input type="number" min="1" value="1" name="qty" id="qty"
                           class="form-control form-control-lg text-center">
                </div>
                <button type="submit" class="btn btn-primary btn-lg flex-grow-1">
                    <i class="fa fa-shopping-bag me-2"></i>
                    {{ t.product_add_to_basket }}
                </button>
            </form>

            <div class="mt-4 pt-3 text-muted small">
                <div class="d-flex gap-4">
                    <span><i class="fa fa-truck me-2"></i> {{ t.badge_free_shipping }}</span>
                    <span><i class="fa fa-shield-alt me-2"></i> {{ t.badge_warranty }}</span>
                </div>
            </div>
        </div>
    </div>
</div>

{% if related %}
<div class="py-4 border-top">
    <h3 class="h5 fw-bold mb-4">{{ t.related_title }}</h3>
    <div class="row row-cols-2 row-cols-md-4 g-3">
        {% for item in related %}
        <div class="col">
            <div class="card h-100 border-0 shadow-sm bg-light">
                <img src="{{ url_for('static', filename='img/' ~ item.image) }}"
                     onerror="this.src='https://placehold.co/300x300?text=Related'"
                     class="card-img-top" style="height: 150px; object-fit: cover;">
                <div class="card-body p-3">
                    <h6 class="card-title fs-6 mb-1 text-truncate">
                        <a href="{{ url_for('product_detail', slug=item.slug) }}"
                           class="text-decoration-none text-dark stretched-link">
                            {{ item.name if lang == 'en' else item.name_zh }}
                        </a>
                    </h6>
                    <div class="text-muted small">
                        {{ item.price }} {{ item.currency }}
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endif %}
{% endblock %}
